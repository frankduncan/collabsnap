<blocks app="Snap! 4.0, http://snap.berkeley.edu" version="1"><block-definition s="topography-stage-width" type="reporter" category="sensing"><header></header><code></code><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.children[0].stage.dimensions.x</l></block><list></list></block></block></script></block-definition><block-definition s="topography-stage-height" type="reporter" category="sensing"><header></header><code></code><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list></list><l>return world.children[0].stage.dimensions.y</l></block><list></list></block></block></script></block-definition><block-definition s="topography-unit-x-position" type="reporter" category="motion"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="topography-stage-to-unit-x %n"><block s="xPosition"></block></custom-block></block></script></block-definition><block-definition s="topography-stage-to-unit-x %&apos;stage-x&apos;" type="reporter" category="operators"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><block s="reportQuotient"><block s="reportSum"><block var="stage-x"/><block s="reportQuotient"><custom-block s="topography-stage-width"></custom-block><l>2</l></block></block><custom-block s="topography-stage-width"></custom-block></block></block></script></block-definition><block-definition s="topography-unit-to-stage-x %&apos;unit-x&apos;" type="reporter" category="operators"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><block s="reportDifference"><block s="reportProduct"><block var="unit-x"/><custom-block s="topography-stage-width"></custom-block></block><block s="reportQuotient"><custom-block s="topography-stage-width"></custom-block><l>2</l></block></block></block></script></block-definition><block-definition s="topography-unit-y-position" type="reporter" category="motion"><header></header><code></code><inputs></inputs><script><block s="doReport"><custom-block s="topography-stage-to-unit-y %n"><block s="yPosition"></block></custom-block></block></script></block-definition><block-definition s="topography-stage-to-unit-y %&apos;stage-y&apos;" type="reporter" category="operators"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><block s="reportQuotient"><block s="reportSum"><block var="stage-y"/><block s="reportQuotient"><custom-block s="topography-stage-height"></custom-block><l>2</l></block></block><custom-block s="topography-stage-height"></custom-block></block></block></script></block-definition><block-definition s="topography-unit-to-stage-y %&apos;unit-y&apos;" type="reporter" category="operators"><header></header><code></code><inputs><input type="%n"></input></inputs><script><block s="doReport"><block s="reportDifference"><block s="reportProduct"><block var="unit-y"/><custom-block s="topography-stage-height"></custom-block></block><block s="reportQuotient"><custom-block s="topography-stage-height"></custom-block><l>2</l></block></block></block></script></block-definition><block-definition s="topography-touching %&apos;name&apos;" type="predicate" category="sensing"><header></header><code></code><inputs><input type="%txt"></input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>neighbors</l><l>name</l></list><l>for (var idx = 0 ; idx &lt; neighbors.length() ; idx ++) {&#xD;  var neighbor = neighbors.at(idx + 1);&#xD;&#xD;  if(Math.abs(this.xPosition() - neighbor.xPosition()) &lt; 25 &amp;&amp;&#xD;     Math.abs(this.yPosition() - neighbor.yPosition()) &lt; 25 &amp;&amp;&#xD;     (neighbor.cloneOriginName === name || neighbor.name === name)) {&#xD;    return true;&#xD;  } &#xD;}&#xD;return false;</l></block><list><block s="reportGet"><l><option>neighbors</option></l></block><block var="name"/></list></block></block></script><scripts><script x="778" y="64"><block s="doDeclareVariables"><list><l>idx</l><l>neighbors</l></list></block><block s="doSetVar"><l>idx</l><l>1</l></block><block s="doSetVar"><l>neighbors</l><block s="reportGet"><l><option>neighbors</option></l></block></block><block s="doUntil"><block s="reportGreaterThan"><block var="idx"/><block s="reportStringSize"><block var="neighbors"/></block></block><script><block s="doDeclareVariables"><list><l>neighbor</l></list></block><block s="doSetVar"><l>neighbor</l><block s="reportListItem"><block var="idx"/><block var="neighbors"/></block></block><block s="doIf"><block s="reportAnd"><block s="evaluate"><block s="reportJSFunction"><list><l>name</l><l>neighbor</l></list><l>return (neighbor.cloneOriginName === name || neighbor.name === name);</l></block><list><block var="name"/><block var="neighbor"/></list></block><block s="evaluate"><block s="reportJSFunction"><list><l>x</l><l>y</l><l>otherX</l><l>otherY</l></list><l>return Math.abs(x - otherX) &lt; 0.05 &amp;&amp; Math.abs(y - otherY) &lt; 0.05;</l></block><list><custom-block s="topography-unit-x-position"></custom-block><custom-block s="topography-unit-y-position"></custom-block><custom-block s="topography-stage-to-unit-x %n"><block s="evaluate"><block s="reportJSFunction"><list><l>neighbor</l></list><l>return neighbor.xPosition();</l></block><list><block var="neighbor"/></list></block></custom-block><custom-block s="topography-stage-to-unit-y %n"><block s="evaluate"><block s="reportJSFunction"><list><l>neighbor</l></list><l>return neighbor.yPosition();</l></block><list><block var="neighbor"/></list></block></custom-block></list></block></block><script><block s="doReport"><block s="reportBoolean"><l><bool>true</bool></l></block></block></script></block><block s="doChangeVar"><l>idx</l><l>1</l></block></script></block><block s="doReport"><block s="reportBoolean"><l><bool>false</bool></l></block></block></script></scripts></block-definition></blocks>